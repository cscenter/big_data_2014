python matrix_parted_mul.py matrix_input
python mincemeat.py -p changeme localhost

Matrix_parted_mul.py - программа для вычисления произведения двух больших матриц. Предполагается, что даже строка матрицы не помещается на одной машине.
Для упрощения кода генерация (key, value) на первом этапе происходит, прочитав всю строку. Но мы можем реализовать свой map_input, который будет читать по одному элементу и генерировать (key,value).
В данный момент r необходимо явно указывать в mapfn.
Самый простой способ размещения элементов итоговой матрицы в DFS после обработки - использовать random access files. Делаем еще один map-reduce для объединения элементов по их индексу [i*r...(i+1)r], а дальше записываем в random access file.
 
Пусть мы вычисляем A*B, где A[m*n], B[n,k], r^2 - максимальное число элементов на одной ноде.
Тогда mapfn порождает ~ n^2 *(m+k)/r событий. Количество различных ключей ~ m*n^2/r^3. Размер каждого списка reduce r^2. 

